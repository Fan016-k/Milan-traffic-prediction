{
    "validation_metrics": {
        "mse": 33995760.0,
        "rmse": 5830.588306509044,
        "mae": 2927.8701171875,
        "mape": 747.7103881835938,
        "r2": 0.8693349361419678,
        "nrmse": 0.035232369458470164,
        "correlation": 0.9413456912855936,
        "directional_accuracy": 0.7111777751312448,
        "peak_rmse": 12155.406369184044,
        "peak_mae": 8584.3544921875,
        "peak_mape": 17.8535099029541,
        "low_rmse": 1464.8747386722184,
        "low_mae": 541.64306640625
    },
    "test_metrics": {
        "mse": 33611372.0,
        "rmse": 5797.531543683052,
        "mae": 2801.9248046875,
        "mape": 2380.829345703125,
        "r2": 0.6670727729797363,
        "nrmse": 0.028971963062799835,
        "correlation": 0.8629409903010415,
        "directional_accuracy": 0.6794086500857799,
        "peak_rmse": 14940.70466878989,
        "peak_mae": 9749.94140625,
        "peak_mape": 33.282657623291016,
        "low_rmse": 1245.7009572927204,
        "low_mae": 698.8776245117188
    },
    "training_history": {
        "train_losses": [
            0.07765337836031837,
            0.048398443139848056,
            0.0449974582599545,
            0.043737132606717445,
            0.042671599744439674,
            0.04219268784099431,
            0.03835319074871087,
            0.03831268765497953,
            0.03787549571306617,
            0.03649960045219847,
            0.03578018422531723,
            0.034482963232289034,
            0.0337442881686406,
            0.03373431883045231,
            0.03250967152416706,
            0.0318435908821239,
            0.03170595201663673,
            0.031070220448007738,
            0.03197184321901726,
            0.03233686260689326,
            0.03728227647607801,
            0.03742082179437771,
            0.03652213052070389,
            0.03552874923183548,
            0.035578268148970825,
            0.034635159445719585,
            0.0342458593443519,
            0.034372112049755675,
            0.03353101512658651,
            0.03343611178247051,
            0.033551785732722945,
            0.03225140653861066,
            0.03220847867756944,
            0.03269491472316009,
            0.031391271795318636,
            0.03128338362849145,
            0.03142554223261498,
            0.031105912971758732,
            0.031791932984358735,
            0.030167674374145765,
            0.029718548926110897,
            0.029904591876806483,
            0.029519056819413823,
            0.0297354797280773,
            0.02971853144656591,
            0.029010809548371645,
            0.029053752927144093,
            0.02790870727902209,
            0.028077368934949238,
            0.028068037751061772,
            0.02756499216667618,
            0.027308982980213368,
            0.027227927495173557,
            0.02681554479662467,
            0.02692177645965583
        ],
        "val_losses": [
            0.19745057984686423,
            0.18792740048633683,
            0.18804655623777458,
            0.19096845946343685,
            0.1822739742109897,
            0.19244181503610755,
            0.193936955028524,
            0.21563924142780402,
            0.22640355299571874,
            0.2346252074499649,
            0.2479714918622954,
            0.23168200648527731,
            0.253596082424607,
            0.2536396598529623,
            0.25272058741689696,
            0.24361521214315737,
            0.26279219555133887,
            0.274055850442016,
            0.266893598837433,
            0.2740690279407082,
            0.26550623834460835,
            0.23411755650994126,
            0.21306565354785156,
            0.23765359284718418,
            0.21879475998812942,
            0.2650103680358303,
            0.24273149748074097,
            0.26407166097002727,
            0.2849706821833496,
            0.2518160945770365,
            0.2512382063626622,
            0.2659888546741395,
            0.23882655212138262,
            0.24847858387511224,
            0.25734244490956404,
            0.2834076348269634,
            0.3088855580814804,
            0.25017068953322313,
            0.24872759838709263,
            0.30945357533723666,
            0.2749023615141158,
            0.2940864240905891,
            0.2931240899402096,
            0.3170820435086541,
            0.29530367356535325,
            0.2957471907225058,
            0.27405710297171026,
            0.27831815766101636,
            0.2849557358271408,
            0.30341194269540545,
            0.29905532851073613,
            0.3213378619488881,
            0.33039183113551523,
            0.309163501408572,
            0.33122271532192826
        ],
        "training_time": "0:51:01.260091",
        "epochs_completed": 55,
        "best_epoch": 5
    },
    "model_info": {
        "total_parameters": 46503073,
        "trainable_parameters": 46503073,
        "model_architecture": "EnhancedLSTMTrafficPredictor(\n  (traffic_cnn): MultiScaleCNN(\n    (convs): ModuleList(\n      (0): Conv1d(30, 52, kernel_size=(3,), stride=(1,), padding=(1,))\n      (1): Conv1d(30, 51, kernel_size=(5,), stride=(1,), padding=(2,))\n      (2): Conv1d(30, 51, kernel_size=(7,), stride=(1,), padding=(3,))\n      (3): Conv1d(30, 51, kernel_size=(11,), stride=(1,), padding=(5,))\n      (4): Conv1d(30, 51, kernel_size=(15,), stride=(1,), padding=(7,))\n    )\n    (bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n    (dropout): Dropout(p=0.1, inplace=False)\n  )\n  (traffic_lstm): LSTM(256, 512, num_layers=5, batch_first=True, dropout=0.15, bidirectional=True)\n  (temporal_encoder): Sequential(\n    (0): Linear(in_features=10, out_features=256, bias=True)\n    (1): ReLU()\n    (2): Dropout(p=0.15, inplace=False)\n    (3): Linear(in_features=256, out_features=256, bias=True)\n  )\n  (temporal_bn): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n  (fusion_layer): Sequential(\n    (0): Linear(in_features=1280, out_features=1024, bias=True)\n    (1): ReLU()\n    (2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)\n    (3): Dropout(p=0.15, inplace=False)\n  )\n  (attention): MultiheadAttention(\n    (out_proj): NonDynamicallyQuantizableLinear(in_features=1024, out_features=1024, bias=True)\n  )\n  (pos_encoding): PositionalEncoding()\n  (prediction_heads): ModuleList(\n    (0-17): 18 x Sequential(\n      (0): Linear(in_features=1024, out_features=512, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.15, inplace=False)\n      (3): Linear(in_features=512, out_features=256, bias=True)\n      (4): ReLU()\n      (5): Linear(in_features=256, out_features=30, bias=True)\n    )\n  )\n  (peak_detector): Sequential(\n    (0): Linear(in_features=1024, out_features=512, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=512, out_features=1, bias=True)\n  )\n  (peak_enhancer): Sequential(\n    (0): Linear(in_features=30, out_features=512, bias=True)\n    (1): ReLU()\n    (2): Linear(in_features=512, out_features=30, bias=True)\n    (3): Tanh()\n  )\n)",
        "config": {
            "BATCH_SIZE": 16,
            "CHECKPOINT_FREQUENCY": 20,
            "DATA_DIRECTORY": "C:\\Users\\Fan\\PycharmProjects\\dataset2\\dataverse_files",
            "DATA_PATH": "C:\\Users\\Fan\\PycharmProjects\\dataset2\\processed_data\\milan_traffic_data_processed_full_memory_efficient.pkl",
            "DROPOUT": 0.15,
            "HIDDEN_DIM": 512,
            "KERNEL_SIZES": [
                3,
                5,
                7,
                11,
                15
            ],
            "LEARNING_RATE": 0.0001,
            "LOG_FREQUENCY": 20,
            "LOG_LEVEL": "INFO",
            "METRICS": [
                "mse",
                "rmse",
                "mae",
                "mape",
                "r2",
                "nrmse",
                "smape",
                "directional_accuracy"
            ],
            "MIN_DELTA": 1e-07,
            "MODEL_TYPE": "enhanced_lstm",
            "NOISE_FACTOR": 0.025,
            "NUM_EPOCHS": 300,
            "NUM_LAYERS": 5,
            "NUM_WORKERS": 1,
            "OUTPUT_BASE_PATH": "output",
            "PATIENCE": 50,
            "PEAK_THRESHOLD_PERCENTILE": 70,
            "PEAK_WEIGHT": 5.0,
            "PIN_MEMORY": true,
            "PREDICTION_HORIZON": 18,
            "SAVE_BEST_MODEL": true,
            "SAVE_CHECKPOINTS": true,
            "SCALER_TYPE": "robust",
            "SCHEDULER_TYPE": "cosine_warm_restart",
            "SEQUENCE_LENGTH": 240,
            "TIME_SHIFT_RANGE": 12,
            "USE_ATTENTION": true,
            "USE_BATCH_NORM": true,
            "USE_CUDA": true,
            "USE_DATA_AUGMENTATION": true,
            "USE_LAYER_NORM": true,
            "USE_MULTI_SCALE": true,
            "USE_PEAK_LOSS": true,
            "USE_RESIDUAL_CONNECTIONS": true,
            "USE_SCHEDULER": true,
            "VIZ_SAMPLE_SIZE": 5000,
            "VIZ_SAVE_DPI": 400,
            "VIZ_WEEKLY_ANALYSIS": true,
            "VIZ_ZOOM_STEPS": 2000,
            "WARMUP_EPOCHS": 25,
            "WEIGHT_DECAY": 1e-05
        }
    },
    "improvements": {
        "rmse_improvement_percent": -2791167.75,
        "mae_improvement_percent": -1656348.625
    }
}